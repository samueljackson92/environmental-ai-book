
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wildfires: MODIS &#8212; The Environmental AI book</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Wildfires: Modelling" href="../wildfires-modelling.html" />
    <link rel="prev" title="Wildfires: Sensors" href="../wildfires-sensors.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The Environmental AI book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../welcome.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Preamble
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../preamble/about.html">
   About this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../preamble/who-for.html">
   Who is the book for?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../preamble/how-to.html">
   How to use this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../preamble/attribution.html">
   How to cite and reuse this material
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Environments
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../forest/forest-overview.html">
   Forest
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../forest/forest-sensors.html">
     Sensors
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../forest/sensors/forest-sensors-fluxnet.html">
       FluxNet
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../forest/forest-modelling.html">
     Modelling
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../forest/modelling/forest-modelling-structure.html">
       Structure
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../forest/modelling/forest-modelling-treecrown.html">
       Tree Crown
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../polar/polar-overview.html">
   Polar
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../polar/polar-sensors.html">
     Sensors
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../polar/sensors/polar-sensors-random.html">
       Random
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../polar/polar-modelling.html">
     Modelling
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../polar/modelling/polar-modelling-temperature.html">
       Temperature
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../urban/urban-overview.html">
   Urban
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../urban/urban-sensors.html">
     Sensors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../urban/urban-modelling.html">
     Modelling
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../wildfires-overview.html">
   Wildfires
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../wildfires-sensors.html">
     Sensors
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       MODIS
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../wildfires-modelling.html">
     Modelling
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Digital Twins
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../digitaltwins/digitaltwins-overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../digitaltwins/digitaltwins-concepts.html">
   Concepts
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Community
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../community/coworking.html">
   Coworking Calls
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../community/coworking/coworking-motivation.html">
     Background, Motivations, and Techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../community/coworking/coworking-collabcafe.html">
     Online Collaboration Cafe
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../community/notes.html">
   Meeting Notes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../community/notes/notes-collabcafe.html">
     <em>
      The Environmental AI
     </em>
     ⛰ 🌳 🏙️ ❄️ 🔥 🌊  online Collaboration Cafe
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../community/notes/notes-journalclub.html">
     Online Journal Club
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../community/templates.html">
   Template Collection
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../community/templates/template-coworking-collabcafe.html">
     Online Collaboration Cafe
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../community/templates/template-coworking-journalclub.html">
     Online Journal Club
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../community/templates/template-environments-sensors.html">
     Environments Use Case Sensors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../community/templates/template-environments-modelling.html">
     Environments Use Case Modelling
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../community/readings.html">
   Interesting readings
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Afterword
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../afterword/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../afterword/bibliography.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../afterword/statistics.html">
   Execution statistics
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/wildfires/sensors/wildfires-sensors-modis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/acocac/environmental-ai-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/acocac/environmental-ai-book/issues/new?title=Issue%20on%20page%20%2Fwildfires/sensors/wildfires-sensors-modis.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/acocac/environmental-ai-book/edit/master/book/wildfires/sensors/wildfires-sensors-modis.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://binder.pangeo.io/v2/gh/acocac/environmental-ai-book/master?urlpath=tree/book/wildfires/sensors/wildfires-sensors-modis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/acocac/environmental-ai-book/blob/master/book/wildfires/sensors/wildfires-sensors-modis.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#context">
   Context
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#purpose">
     Purpose
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sensor-description">
     Sensor description
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#highlights">
     Highlights
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#authors">
     Authors
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-and-load-libraries">
   Install and load libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fetch-data">
   Fetch Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-modis-satellite-data">
   Load MODIS Satellite Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resample-to-a-different-projection">
     Resample to a different projection
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-modis-fire-database">
   Load MODIS Fire Database
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#daily-fire-radiative-power">
     Daily Fire Radiative Power
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#geographical-distribution-of-fires">
     Geographical distribution of Fires
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualising-fire-pixels-with-satellite-imagery">
   Visualising Fire Pixels with Satellite Imagery
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="wildfires-modis">
<h1>Wildfires: MODIS<a class="headerlink" href="#wildfires-modis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="context">
<h2>Context<a class="headerlink" href="#context" title="Permalink to this headline">¶</a></h2>
<div class="section" id="purpose">
<h3>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h3>
<p>Explore <a class="reference external" href="https://cmr.earthdata.nasa.gov/search/concepts/C1378227407-LAADS.html">MODIS</a> satellite imagery and wildfire data that is open and free for scientific use.</p>
</div>
<div class="section" id="sensor-description">
<h3>Sensor description<a class="headerlink" href="#sensor-description" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://cmr.earthdata.nasa.gov/search/concepts/C1378227407-LAADS.html">MOD021KM</a> product contains calibrated and geolocated at-aperture radiances for 36 discrete bands located in the 0.4 to 14.4 micron region of the electromagnetic spectrum.</p>
</div>
<div class="section" id="highlights">
<h3>Highlights<a class="headerlink" href="#highlights" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">satpy</span></code> to load, visualise, and regrid MODIS level 1B data.</p></li>
<li><p>Fetch a fire database contains some 65552 fires mostly distributed across central and southern Africa.</p></li>
<li><p>Visulisation of fire pixels from the database</p></li>
<li><p>Visulisation of the fire pixels alongside bands from the MODIS satellite data.</p></li>
</ul>
</div>
<div class="section" id="authors">
<h3>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h3>
<p>Samuel Jackson, Science &amp; Technology Facilities Council, <a class="reference external" href="https://github.com/samueljackson92">&#64;samueljackson92</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The author acknowledges <a class="reference external" href="https://doi.org/10.5067/modis/mod021km.061">MODIS Science Team</a> and the use of data and/or imagery from NASA’s Fire Information for Resource Management System (FIRMS) (<a class="reference external" href="https://earthdata.nasa.gov/firms">https://earthdata.nasa.gov/firms</a>), part of NASA’s Earth Observing System Data and Information System (EOSDIS).</p>
</div>
</div>
</div>
<div class="section" id="install-and-load-libraries">
<h2>Install and load libraries<a class="headerlink" href="#install-and-load-libraries" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span> pip install <span class="s1">&#39;satpy==0.26.0&#39;</span> gdown
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">intake</span>
<span class="kn">import</span> <span class="nn">netrc</span><span class="o">,</span> <span class="nn">fsspec</span><span class="o">,</span> <span class="nn">aiohttp</span>
<span class="kn">import</span> <span class="nn">hvplot.xarray</span>
<span class="kn">import</span> <span class="nn">hvplot.pandas</span>
<span class="kn">import</span> <span class="nn">holoviews</span> <span class="k">as</span> <span class="nn">hv</span>
<span class="kn">import</span> <span class="nn">panel</span> <span class="k">as</span> <span class="nn">pn</span>
<span class="kn">import</span> <span class="nn">satpy</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">cKDTree</span>
<span class="kn">from</span> <span class="nn">satpy.writers</span> <span class="kn">import</span> <span class="n">get_enhanced_image</span>
<span class="kn">from</span> <span class="nn">getpass</span> <span class="kn">import</span> <span class="n">getpass</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">pyresample</span> <span class="kn">import</span> <span class="n">geometry</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="fetch-data">
<h2>Fetch Data<a class="headerlink" href="#fetch-data" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To download data from the <a class="reference external" href="https://urs.earthdata.nasa.gov/">NASA’s Earth Data site</a> you must have a valid Earth Data account. Please register with Earth Data is you do not already have an account and then provide your username and password when prompted in the cell below.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">username</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Username: &#39;</span><span class="p">)</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">getpass</span><span class="p">(</span><span class="s1">&#39;Password: &#39;</span><span class="p">)</span>
    
<span class="n">fsspec</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;https&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">client_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;auth&#39;</span><span class="p">:</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">BasicAuth</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)})</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://ladsweb.modaps.eosdis.nasa.gov/archive/allData/61/MOD021KM/2020/245/MOD021KM.A2020245.0840.061.2020245193036.hdf&#39;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
        <span class="n">handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Download the database of MODIS wildfires from a publically accessible location.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>gdown <span class="s1">&#39;https://drive.google.com/uc?id=1VUDIUysR8uFo72q-HFCRdF6qP3eDh_CN&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Load an intake catalog for the downloaded data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">())</span>
<span class="n">catalog_file</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="s1">&#39;catalog.yaml&#39;</span>

<span class="k">with</span> <span class="n">catalog_file</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">sources:</span>
<span class="s1">    modis_l1b:</span>
<span class="s1">      args:</span>
<span class="s1">        urlpath: &#39;MOD021KM.A2020245.0840.061.2020245193036.hdf&#39;</span>
<span class="s1">        reader: &#39;modis_l1b&#39;</span>
<span class="s1">      description: &quot;MODIS Level 1B Products&quot;</span>
<span class="s1">      driver: SatpySource</span>
<span class="s1">      metadata: </span><span class="si">{}</span><span class="s1"></span>
<span class="s1">    modis_fires:</span>
<span class="s1">      args:</span>
<span class="s1">        urlpath: &#39;fire_archive_M-C61_210084.csv&#39;</span>
<span class="s1">      description: &quot;MODIS Level 2 Fires&quot;</span>
<span class="s1">      driver: csv</span>
<span class="s1">      metadata: </span><span class="si">{}</span><span class="s1"></span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">intake.source.base</span> <span class="kn">import</span> <span class="n">PatternMixin</span>
<span class="kn">from</span> <span class="nn">intake.source.base</span> <span class="kn">import</span> <span class="n">DataSource</span><span class="p">,</span> <span class="n">Schema</span>

<span class="kn">import</span> <span class="nn">glob</span>

<span class="k">class</span> <span class="nc">SatpySource</span><span class="p">(</span><span class="n">DataSource</span><span class="p">,</span> <span class="n">PatternMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Intake driver for data supported by satpy.Scene&quot;&quot;&quot;</span>
    
    <span class="n">container</span> <span class="o">=</span> <span class="s1">&#39;python&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;satpy&#39;</span>
    <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;0.0.1&#39;</span>
    <span class="n">partition_access</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urlpath</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path_as_pattern</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path: str, location of model pkl file</span>
<span class="sd">        Either the absolute or relative path to the file</span>
<span class="sd">        opened. Some examples:</span>
<span class="sd">          - ``{{ CATALOG_DIR }}/file.nat``</span>
<span class="sd">          - ``{{ CATALOG_DIR }}/*.nc``</span>
<span class="sd">        reader: str, optional</span>
<span class="sd">        Name of the satpy reader to use when loading data (ie. ``modis_l1b``)</span>
<span class="sd">        metadata: dict, optional</span>
<span class="sd">        Additional metadata to pass to the intake catalog</span>
<span class="sd">        path_as_pattern: bool or str, optional</span>
<span class="sd">        Whether to treat the path as a pattern (ie. ``data_{field}.nc``)</span>
<span class="sd">        and create new coodinates in the output corresponding to pattern</span>
<span class="sd">        fields. If str, is treated as pattern to match on. Default is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">path_as_pattern</span> <span class="o">=</span> <span class="n">path_as_pattern</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">urlpath</span> <span class="o">=</span> <span class="n">urlpath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span> <span class="o">=</span> <span class="n">reader</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SatpySource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">urlpath</span>
        <span class="n">files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">files</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">satpy</span><span class="o">.</span><span class="n">Scene</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_reader</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="o">=</span> <span class="n">Schema</span><span class="p">(</span>
            <span class="n">npartitions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">extra_metadata</span><span class="o">=</span><span class="p">{}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_metadata</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load</span><span class="p">()</span>

<span class="n">intake</span><span class="o">.</span><span class="n">register_driver</span><span class="p">(</span><span class="s1">&#39;SatpySource&#39;</span><span class="p">,</span> <span class="n">SatpySource</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">intake</span><span class="o">.</span><span class="n">open_catalog</span><span class="p">(</span><span class="n">catalog_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-modis-satellite-data">
<h2>Load MODIS Satellite Data<a class="headerlink" href="#load-modis-satellite-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scn</span> <span class="o">=</span> <span class="n">cat</span><span class="p">[</span><span class="s1">&#39;modis_l1b&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">scn</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scn</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="s1">&#39;true_color&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">],</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">scn</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;true_color&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="resample-to-a-different-projection">
<h3>Resample to a different projection<a class="headerlink" href="#resample-to-a-different-projection" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">area_id</span> <span class="o">=</span> <span class="s2">&quot;Southern Africa&quot;</span>
<span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Southern Africa in Mercator-Projection&quot;</span>
<span class="n">proj_id</span> <span class="o">=</span> <span class="s2">&quot;Southern Africa&quot;</span>
<span class="n">proj_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;proj&quot;</span><span class="p">:</span> <span class="s2">&quot;eqc&quot;</span><span class="p">}</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">1000</span>    <span class="c1"># width of the result domain in pixels</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">1000</span>   <span class="c1"># height of the result domain in pixels</span>

<span class="n">llx</span> <span class="o">=</span>  <span class="mf">23E5</span>   <span class="c1"># projection x coordinate of lower left corner of lower left pixel</span>
<span class="n">lly</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">22.9E5</span>   <span class="c1"># projection y coordinate of lower left corner of lower left pixel</span>
<span class="n">urx</span> <span class="o">=</span>  <span class="mf">48E5</span>   <span class="c1"># projection x coordinate of upper right corner of upper right pixel</span>
<span class="n">ury</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">1.9E5</span>   <span class="c1"># projection y coordinate of upper right corner of upper right pixel</span>

<span class="n">area_extent</span> <span class="o">=</span> <span class="p">(</span><span class="n">llx</span><span class="p">,</span><span class="n">lly</span><span class="p">,</span><span class="n">urx</span><span class="p">,</span><span class="n">ury</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyresample</span> <span class="kn">import</span> <span class="n">create_area_def</span>
<span class="n">resolution</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">center</span> <span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">area_def</span> <span class="o">=</span> <span class="n">create_area_def</span><span class="p">(</span><span class="n">area_id</span><span class="p">,</span> <span class="n">proj_dict</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">)</span>

<span class="n">modis_scn</span> <span class="o">=</span> <span class="n">scn</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">area_def</span><span class="p">,</span> <span class="n">radius_of_influence</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modis_scn</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;true_color&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="load-modis-fire-database">
<h2>Load MODIS Fire Database<a class="headerlink" href="#load-modis-fire-database" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fires</span> <span class="o">=</span> <span class="n">cat</span><span class="p">[</span><span class="s1">&#39;modis_fires&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">fires</span><span class="o">.</span><span class="n">acq_date</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">fires</span><span class="o">.</span><span class="n">acq_time</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">fires</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H%M&#39;</span><span class="p">)</span>
<span class="n">fires</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
    <span class="n">fires</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geopandas</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">fires</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">fires</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>

<span class="c1"># We&#39;re only interested in data from Southern Africa for now</span>
<span class="n">llx</span> <span class="o">=</span>  <span class="mi">0</span>    <span class="c1"># projection x coordinate of lower left corner of lower left pixel</span>
<span class="n">lly</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">30</span>  <span class="c1"># projection y coordinate of lower left corner of lower left pixel</span>
<span class="n">urx</span> <span class="o">=</span>  <span class="mi">55</span>   <span class="c1"># projection x coordinate of upper right corner of upper right pixel</span>
<span class="n">ury</span> <span class="o">=</span>  <span class="mi">10</span>   <span class="c1"># projection y coordinate of upper right corner of upper right pixel</span>

<span class="n">fires</span> <span class="o">=</span> <span class="n">fires</span><span class="o">.</span><span class="n">cx</span><span class="p">[</span><span class="n">llx</span><span class="p">:</span><span class="n">urx</span><span class="p">,</span> <span class="n">lly</span><span class="p">:</span><span class="n">ury</span><span class="p">]</span>
<span class="n">fires</span> <span class="o">=</span> <span class="n">fires</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fires</span><span class="o">.</span><span class="n">satellite</span> <span class="o">==</span> <span class="s1">&#39;Terra&#39;</span><span class="p">]</span>
<span class="n">fires</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="daily-fire-radiative-power">
<h3>Daily Fire Radiative Power<a class="headerlink" href="#daily-fire-radiative-power" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_timeseries</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">y_variable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Timeseries plot showing the mean fire radiative power at each day as well as the 5% and 95%&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">percentile</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">percentile_</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">percentile_</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="s1">&#39;percentile_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">n</span>
        <span class="k">return</span> <span class="n">percentile_</span>
    
    <span class="n">tseries</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Overlay</span><span class="p">([</span>
        <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;acq_date&#39;</span><span class="p">])[</span><span class="n">y_variable</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">percentile</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">percentile</span><span class="p">(</span><span class="mi">95</span><span class="p">)])</span>
         <span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="s1">&#39;acq_date&#39;</span><span class="p">,</span> <span class="s1">&#39;percentile_5&#39;</span><span class="p">,</span> <span class="s1">&#39;percentile_95&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)),</span>
            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;acq_date&#39;</span><span class="p">])[</span><span class="n">y_variable</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">hvplot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Average Daily FRP&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)])</span>

    <span class="k">return</span> <span class="n">tseries</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">xrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Day&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;FRP (MW)&#39;</span><span class="p">,</span><span class="n">legend_position</span><span class="o">=</span><span class="s1">&#39;top_left&#39;</span><span class="p">)</span>

<span class="n">plot_timeseries</span><span class="p">(</span><span class="n">fires</span><span class="p">,</span> <span class="s1">&#39;frp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="geographical-distribution-of-fires">
<h3>Geographical distribution of Fires<a class="headerlink" href="#geographical-distribution-of-fires" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fires</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s1">&#39;acq_date&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;frp&#39;</span><span class="p">,</span> <span class="n">geo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> 
                    <span class="n">tiles</span><span class="o">=</span><span class="s1">&#39;ESRI&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="n">llx</span><span class="p">,</span> <span class="n">urx</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">lly</span><span class="p">,</span> <span class="n">ury</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;autumn&#39;</span><span class="p">,</span> <span class="n">logz</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                    <span class="n">dynamic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="visualising-fire-pixels-with-satellite-imagery">
<h2>Visualising Fire Pixels with Satellite Imagery<a class="headerlink" href="#visualising-fire-pixels-with-satellite-imagery" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modis_dataset</span> <span class="o">=</span> <span class="n">modis_scn</span><span class="o">.</span><span class="n">to_xarray_dataset</span><span class="p">()</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">get_enhanced_image</span><span class="p">(</span><span class="n">modis_scn</span><span class="p">[</span><span class="s1">&#39;true_color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">data</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="n">modis_dataset</span><span class="p">[</span><span class="s1">&#39;true_color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">modis_scn</span><span class="o">.</span><span class="n">min_area</span><span class="p">()</span><span class="o">.</span><span class="n">get_lonlats</span><span class="p">()</span>
<span class="n">lons</span><span class="p">,</span> <span class="n">lats</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">modis_dataset</span> <span class="o">=</span> <span class="n">modis_dataset</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lons</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">lats</span><span class="p">))</span>
<span class="n">modis_dataset</span> <span class="o">=</span> <span class="n">modis_dataset</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span>

<span class="n">rgb</span> <span class="o">=</span> <span class="n">modis_dataset</span><span class="p">[</span><span class="s1">&#39;true_color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">rgb</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="s1">&#39;bands&#39;</span><span class="p">)</span>
<span class="n">rgb</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">modis_scn</span><span class="o">.</span><span class="n">min_area</span><span class="p">()</span><span class="o">.</span><span class="n">get_lonlats</span><span class="p">()</span>

<span class="c1"># Mask any fire pixels not in this scene</span>
<span class="n">time_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">fires</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">&gt;=</span> <span class="n">scn</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;start_time&#39;</span><span class="p">],</span> 
                           <span class="n">fires</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">&lt;=</span> <span class="n">scn</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;end_time&#39;</span><span class="p">])</span>
<span class="n">fire_points</span> <span class="o">=</span> <span class="n">fires</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">time_mask</span><span class="p">]</span>
<span class="n">fire_points</span> <span class="o">=</span> <span class="n">fire_points</span><span class="o">.</span><span class="n">cx</span><span class="p">[</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">():</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">():</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>

<span class="c1"># extract the x and y coordinates as flat arrays</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

<span class="c1"># Find locations of fire pixels within satellite image</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">cKDTree</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="n">distance</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">fire_points</span><span class="p">[[</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">]],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">index</span>

<span class="n">fire_points</span><span class="p">[[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">index</span>
<span class="n">fire_points</span> <span class="o">=</span> <span class="n">fire_points</span><span class="p">[</span><span class="n">img</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">index</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">fire_points</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rgb</span> <span class="o">=</span> <span class="n">modis_dataset</span><span class="p">[</span><span class="s1">&#39;true_color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">rgb</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="s1">&#39;bands&#39;</span><span class="p">,</span> <span class="n">data_aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hover</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;True Colour&#39;</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">fire_points</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;frp&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;autumn&#39;</span><span class="p">,</span> <span class="n">logz</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">rgb</span><span class="o">*</span><span class="n">points</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rgb</span> <span class="o">=</span> <span class="n">modis_dataset</span><span class="p">[</span><span class="s1">&#39;20&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">data_aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hover</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Band 20: 3.7 micron&#39;</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">fire_points</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;frp&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;autumn&#39;</span><span class="p">,</span> <span class="n">logz</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">rgb</span><span class="o">*</span><span class="n">points</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "pangeo"
        },
        kernelOptions: {
            kernelName: "pangeo",
            path: "./wildfires/sensors"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'pangeo'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../wildfires-sensors.html" title="previous page">Wildfires: Sensors</a>
    <a class='right-next' id="next-link" href="../wildfires-modelling.html" title="next page">Wildfires: Modelling</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Environmental AI Community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>